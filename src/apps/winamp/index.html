<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>Winamp</title>
    <style>
        body,
        html {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            background-color: #292929;
            /* Fallback */
        }

        #app {
            width: 100%;
            height: 100%;
        }
    </style>
</head>

<body>
    <div id="app"></div>
    <script src="lib/webamp.bundle.min.js"></script>
    <script>
        const app = document.getElementById("app");
        if (window.Webamp) {
            console.log("Webamp detected. Initializing with availableSkins...");
            
            const skins = [
                { url: "skins/Excel_Skin.wsz", name: "Excel Skin" },
                { url: "skins/MIKU%20v3%20by%20jenny1437.wsz", name: "Miku v3" },
                { url: "skins/Rei_Ayanami_Amp_2.wsz", name: "Rei Ayanami" },
                { url: "skins/undertale-by-luigihann.wsz", name: "Undertale" },
                { url: "skins/winampskin_D-Shock.zip", name: "D-Shock" },
                { url: "skins/wired_lain.wsz", name: "Wired Lain" }
            ];

            // Webamp constructor options
            const options = {
                initialTracks: [
                    {
                        metaData: { artist: "Winamp", title: "Llama Whippin' (Intro)" },
                        url: "mp3/llama-2.91.mp3"
                    }
                ],
                initialSkin: {
                    url: "skins/Excel_Skin.wsz"
                },
                availableSkins: skins,
                // Some older versions or forks might use these:
                skins: skins,
                skinUrls: skins.map(s => s.url),
                zIndex: 1
            };

            const webamp = new Webamp(options);

            webamp.renderWhenReady(app).then(() => {
                console.log('Webamp rendered.');
                console.log('Constructor options used:', options);
                
                // Debug: List all available methods and properties on the instance
                console.log('Webamp instance properties:', Object.keys(webamp));
                
                // Try to find a method to add skins post-initialization if availableSkins fails
                if (webamp.appendSkins) {
                    console.log('Found appendSkins method, calling it...');
                    webamp.appendSkins(skins);
                } else if (webamp.addSkins) {
                    console.log('Found addSkins method, calling it...');
                    webamp.addSkins(skins);
                }
            }).catch(err => {
                console.error("Error rendering Webamp:", err);
            });

            // Global debug helper
            window.webampDebug = {
                instance: webamp,
                skins: skins,
                setSkin: (url) => webamp.setSkinFromUrl(url)
            };
        } else {
            console.error("Webamp library not loaded!");
        }
    </script>
</body>

</html>